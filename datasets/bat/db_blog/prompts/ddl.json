[
  {
    "id": 43,
    "nl_prompt": "Update the labels table to include a json field called comments_description.",
    "query_type": "ddl",
    "database": "db_blog",
    "dialects": [
      "postgres",
      "mysql",
      "sqlserver",
      "sqlite"
    ],
    "golden_sql": {
      "postgres": [
        "ALTER TABLE tbl_labels ADD COLUMN comments_description JSON;"
      ],
      "mysql": [
        "ALTER TABLE tbl_labels ADD COLUMN comments_description JSON;"
      ],
      "sqlserver": [
        "ALTER TABLE tbl_labels ADD comments_description NVARCHAR(MAX);"
      ],
      "sqlite": [
        "ALTER TABLE tbl_labels ADD COLUMN comments_description TEXT CHECK (json_valid(comments_description));"
      ]
    },
    "eval_query": {
      "postgres": [
        "SELECT COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME='tbl_labels' AND column_name='comments_description' AND data_type = 'json'"
      ],
      "mysql": [
        "SELECT COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME='tbl_labels' AND column_name='comments_description' AND data_type = 'json'"
      ],
      "sqlserver": [
        "SELECT COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = 'tbl_labels' AND COLUMN_NAME = 'comments_description' AND DATA_TYPE = 'nvarchar';"
      ],
      "sqlite": [
        "SELECT COUNT(*) FROM tbl_labels WHERE json_valid(comments_description);"
      ]
    },
    "setup_sql": {
      "postgres": [
        "ALTER TABLE tbl_labels DROP COLUMN comments_description;"
      ],
      "mysql": [
        "ALTER TABLE tbl_labels DROP COLUMN comments_description;"
      ],
      "sqlserver": [
        "ALTER TABLE tbl_labels DROP COLUMN comments_description;"
      ],
      "sqlite": [
        "BEGIN TRANSACTION; CREATE TABLE tbl_labels_new (label_id INTEGER PRIMARY KEY, creator_id INTEGER DEFAULT NULL, updated_by INTEGER DEFAULT NULL, name TEXT DEFAULT NULL, description TEXT DEFAULT NULL, created_at TEXT DEFAULT NULL, updated_at TEXT DEFAULT NULL, post_count INTEGER DEFAULT NULL, visibility_status TEXT DEFAULT NULL, is_active INTEGER DEFAULT NULL, usage_frequency INTEGER DEFAULT NULL, parent_label_id INTEGER DEFAULT NULL, FOREIGN KEY (creator_id) REFERENCES tbl_users(user_id), FOREIGN KEY (updated_by) REFERENCES tbl_users(user_id), FOREIGN KEY (parent_label_id) REFERENCES tbl_labels(label_id)); INSERT INTO tbl_labels_new (label_id, creator_id, updated_by, name, description, created_at, updated_at, post_count, visibility_status, is_active, usage_frequency, parent_label_id) SELECT label_id, creator_id, updated_by, name, description, created_at, updated_at, post_count, visibility_status, is_active, usage_frequency, parent_label_id FROM tbl_labels; DROP TABLE tbl_labels; ALTER TABLE tbl_labels_new RENAME TO tbl_labels; COMMIT;"
      ]
    },
    "cleanup_sql": {
      "postgres": [
        "ALTER TABLE tbl_labels DROP COLUMN comments_description;"
      ],
      "mysql": [
        "ALTER TABLE tbl_labels DROP COLUMN comments_description;"
      ],
      "sqlserver": [  
        "ALTER TABLE tbl_labels DROP COLUMN comments_description;"  
      ],
      "sqlite": [
        "BEGIN TRANSACTION; CREATE TABLE tbl_labels_new (label_id INTEGER PRIMARY KEY, creator_id INTEGER DEFAULT NULL, updated_by INTEGER DEFAULT NULL, name TEXT DEFAULT NULL, description TEXT DEFAULT NULL, created_at TEXT DEFAULT NULL, updated_at TEXT DEFAULT NULL, post_count INTEGER DEFAULT NULL, visibility_status TEXT DEFAULT NULL, is_active INTEGER DEFAULT NULL, usage_frequency INTEGER DEFAULT NULL, parent_label_id INTEGER DEFAULT NULL, FOREIGN KEY (creator_id) REFERENCES tbl_users(user_id), FOREIGN KEY (updated_by) REFERENCES tbl_users(user_id), FOREIGN KEY (parent_label_id) REFERENCES tbl_labels(label_id)); INSERT INTO tbl_labels_new (label_id, creator_id, updated_by, name, description, created_at, updated_at, post_count, visibility_status, is_active, usage_frequency, parent_label_id) SELECT label_id, creator_id, updated_by, name, description, created_at, updated_at, post_count, visibility_status, is_active, usage_frequency, parent_label_id FROM tbl_labels; DROP TABLE tbl_labels; ALTER TABLE tbl_labels_new RENAME TO tbl_labels; COMMIT;"
      ]
    },
    "tags": [
      "DDL",
      "difficulty: simple",
      "ALTER",
      "ADD_COLUMN",
      "JSON"
    ],
    "other": {
      "Comment": "LGTM",
      "nl_prompt_base": "Update the labels table to include a json type field called comments_description.",
      "nl_prompt_extra_context": null,
      "public": true
    }
  },
  {
    "id": 185,
    "nl_prompt": "Rename the content column in the tbl_posts table to post_content",
    "query_type": "ddl",
    "database": "db_blog",
    "dialects": [
      "postgres",
      "mysql",
      "sqlserver",
      "sqlite"
    ],
    "golden_sql": {
      "postgres": [
        "ALTER TABLE tbl_posts RENAME COLUMN content TO post_content;"
      ],
      "mysql": [
        "ALTER TABLE tbl_posts RENAME COLUMN content TO post_content;"
      ],
      "sqlserver": [
        "EXEC sp_rename 'tbl_posts.content', 'post_content', 'COLUMN';"
      ],
      "sqlite": [
        "ALTER TABLE tbl_posts RENAME COLUMN content TO post_content;"
      ]
    },
    "eval_query": {
      "postgres": [
        "SELECT post_content FROM tbl_posts;"
      ],
      "mysql": [
        "SELECT post_content FROM tbl_posts;"
      ],
      "sqlserver": [
        "SELECT post_content FROM tbl_posts;"
      ],
      "sqlite": [
        "SELECT post_content FROM tbl_posts;"
      ]
    },
    "setup_sql": {
      "postgres": [
        "ALTER TABLE tbl_posts RENAME COLUMN post_content TO content;"
      ],
      "mysql": [
        "ALTER TABLE tbl_posts RENAME COLUMN post_content TO content;"
      ],
      "sqlserver": [
        "EXEC sp_rename 'tbl_posts.post_content', 'content', 'COLUMN';"
      ],
      "sqlite": [
        "ALTER TABLE tbl_posts RENAME COLUMN post_content TO content;"
      ]
    },
    "cleanup_sql": {
      "postgres": [
        "ALTER TABLE tbl_posts RENAME COLUMN post_content TO content;"
      ],
      "mysql": [
        "ALTER TABLE tbl_posts RENAME COLUMN post_content TO content;"
      ],
      "sqlserver": [
        "EXEC sp_rename 'tbl_posts.post_content', 'content', 'COLUMN';"
      ],
      "sqlite": [
        "ALTER TABLE tbl_posts RENAME COLUMN post_content TO content;"
      ]
    },
    "tags": [
      "DDL",
      "difficulty: simple",
      "ALTER",
      "RENAME"
    ],
    "other": {
      "comment": "LGTM",
      "nl_prompt_base": "Rename the content column in the tbl_posts table to post_content",
      "nl_prompt_extra_context": null,
      "public": true
    }
  },
  {
    "id": 255,
    "nl_prompt": "Create an Enumerated Type for Access Levels",
    "query_type": "ddl",
    "database": "db_blog",
    "dialects": [
      "postgres",
      "mysql",
      "sqlserver",
      "sqlite"
    ],
    "golden_sql": {
      "postgres": [
        "ALTER TABLE tbl_tags ADD COLUMN access_level_enum VARCHAR(10) CHECK (access_level_enum IN ('Public', 'Private', 'Restricted'));"
      ],
      "mysql": [
        "ALTER TABLE tbl_tags ADD COLUMN access_level_enum ENUM('Public', 'Private', 'Restricted');"
      ],
      "sqlserver": [
        "ALTER TABLE tbl_tags ADD access_level_enum VARCHAR(10) CONSTRAINT chk_access_level CHECK (access_level_enum IN ('Public', 'Private', 'Restricted'));"
      ],
      "sqlite":[
        "ALTER TABLE tbl_tags ADD COLUMN access_level_enum TEXT CHECK (access_level_enum IN ('Public', 'Private', 'Restricted'));"
      ]
    },
    "eval_query": {
      "postgres": [
        "SELECT count(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME='tbl_tags' AND column_name='access_level_enum '"
      ],
      "mysql": [
        "SELECT count(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME='tbl_tags' AND column_name='access_level_enum '"
      ],
      "sqlserver": [
        "SELECT COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = 'tbl_tags' AND COLUMN_NAME = 'access_level_enum';"
      ],
      "sqlite": [
        "SELECT COUNT(*) FROM PRAGMA_TABLE_INFO('tbl_tags') WHERE name = 'access_level_enum';"
      ]
    },
    "setup_sql": {
      "postgres": [
        "ALTER TABLE tbl_tags DROP COLUMN IF EXISTS access_level_enum;"
      ],
      "mysql": [
        "ALTER TABLE tbl_tags DROP COLUMN access_level_enum;"
      ],
      "sqlserver": [
        "ALTER TABLE tbl_tags DROP CONSTRAINT chk_access_level, COLUMN access_level_enum;"
      ],
      "sqlite": [
        "BEGIN TRANSACTION; CREATE TABLE tbl_tags_new (tag_id INTEGER NOT NULL PRIMARY KEY, creator_id INTEGER DEFAULT NULL, category_id INTEGER DEFAULT NULL, name TEXT DEFAULT NULL, description TEXT DEFAULT NULL, created_at TIMESTAMP DEFAULT NULL, updated_at TIMESTAMP DEFAULT NULL, slug TEXT DEFAULT NULL, count INTEGER DEFAULT NULL, visibility BOOLEAN DEFAULT NULL, active BOOLEAN DEFAULT NULL, parent_tag INTEGER DEFAULT NULL, status_id INTEGER DEFAULT NULL, access_level INTEGER DEFAULT NULL, is_approved BOOLEAN DEFAULT NULL, metadata JSON DEFAULT NULL, is_edited BOOLEAN DEFAULT NULL, FOREIGN KEY (creator_id) REFERENCES tbl_users(user_id), FOREIGN KEY (category_id) REFERENCES tbl_categories(category_id)); INSERT INTO tbl_tags_new (tag_id, creator_id, category_id, name, description, created_at, updated_at, slug, count, visibility, active, parent_tag, status_id, access_level, is_approved, metadata, is_edited) SELECT tag_id, creator_id, category_id, name, description, created_at, updated_at, slug, count, visibility, active, parent_tag, status_id, access_level, is_approved, metadata, is_edited FROM tbl_tags; DROP TABLE tbl_tags; ALTER TABLE tbl_tags_new RENAME TO tbl_tags; COMMIT;"
      ]
    },
    "cleanup_sql": {
      "postgres": [
        "ALTER TABLE tbl_tags DROP COLUMN IF EXISTS access_level_enum;"
      ],
      "mysql": [
        "ALTER TABLE tbl_tags DROP COLUMN access_level_enum;"
      ],
      "sqlserver": [
        "ALTER TABLE tbl_tags DROP CONSTRAINT chk_access_level, COLUMN access_level_enum;"
      ],
      "sqlite":[
        "BEGIN TRANSACTION; CREATE TABLE tbl_tags_new (tag_id INTEGER NOT NULL PRIMARY KEY, creator_id INTEGER DEFAULT NULL, category_id INTEGER DEFAULT NULL, name TEXT DEFAULT NULL, description TEXT DEFAULT NULL, created_at TIMESTAMP DEFAULT NULL, updated_at TIMESTAMP DEFAULT NULL, slug TEXT DEFAULT NULL, count INTEGER DEFAULT NULL, visibility BOOLEAN DEFAULT NULL, active BOOLEAN DEFAULT NULL, parent_tag INTEGER DEFAULT NULL, status_id INTEGER DEFAULT NULL, access_level INTEGER DEFAULT NULL, is_approved BOOLEAN DEFAULT NULL, metadata JSON DEFAULT NULL, is_edited BOOLEAN DEFAULT NULL, FOREIGN KEY (creator_id) REFERENCES tbl_users(user_id), FOREIGN KEY (category_id) REFERENCES tbl_categories(category_id)); INSERT INTO tbl_tags_new (tag_id, creator_id, category_id, name, description, created_at, updated_at, slug, count, visibility, active, parent_tag, status_id, access_level, is_approved, metadata, is_edited) SELECT tag_id, creator_id, category_id, name, description, created_at, updated_at, slug, count, visibility, active, parent_tag, status_id, access_level, is_approved, metadata, is_edited FROM tbl_tags; DROP TABLE tbl_tags; ALTER TABLE tbl_tags_new RENAME TO tbl_tags; COMMIT;"
      ]
    },
    "tags": [
      "DDL",
      "difficulty: simple",
      "CREATE",
      "ENUM",
      "ALTER",
      "ADD_COLUMN"
    ],
    "other": {
      "nl_prompt_base": "Create an Enumerated Type for Access Levels",
      "nl_prompt_extra_context": null,
      "public": true
    }
  },
  {
    "id": 256,
    "nl_prompt": "Add a Generated Column full_name to tbl_users. -- Store first name and last name concatenated",
    "query_type": "ddl",
    "database": "db_blog",
    "dialects": [
      "postgres",
      "mysql",
      "sqlserver",
      "sqlite"
    ],
    "golden_sql": {
      "postgres": [
        "ALTER TABLE tbl_users ADD COLUMN full_name VARCHAR(255) GENERATED ALWAYS AS (first_name || ' ' || last_name) STORED;"
      ],
      "mysql": [
        "ALTER TABLE tbl_users ADD COLUMN full_name VARCHAR(255) GENERATED ALWAYS AS (CONCAT(first_name, ' ', last_name)) STORED;"
      ],
      "sqlserver": [
        "ALTER TABLE tbl_users ADD full_name AS CONCAT(first_name, ' ', last_name) PERSISTED;"
      ],
      "sqlite": [
        "ALTER TABLE tbl_users ADD COLUMN full_name TEXT GENERATED ALWAYS AS (first_name || ' ' || last_name) VIRTUAL;"
      ]
    },
    "eval_query": {
      "postgres": [
        "SELECT count(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME='tbl_users' AND column_name='full_name'"
      ],
      "mysql": [
        "SELECT count(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME='tbl_users' AND column_name='full_name'"
      ],
      "sqlserver": [
        "SELECT COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = 'tbl_users' AND COLUMN_NAME = 'full_name';"
      ],
      "sqlite": [
        "SELECT COUNT(*) FROM pragma_table_info('tbl_users') WHERE name = 'full_name';"
      ]
    },
    "setup_sql": {
      "postgres": [
        "ALTER TABLE tbl_users DROP COLUMN IF EXISTS full_name;"
      ],
      "mysql": [
        "ALTER TABLE tbl_users DROP COLUMN full_name;"
      ],
      "sqlserver": [
        "IF EXISTS (SELECT 1 FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = 'tbl_users' AND COLUMN_NAME = 'full_name') ALTER TABLE tbl_users DROP COLUMN full_name;"
      ],
      "sqlite": [
        "BEGIN TRANSACTION; CREATE TABLE tbl_users_new (user_id INTEGER PRIMARY KEY, first_name TEXT, last_name TEXT, username TEXT, password_hash TEXT, social_media_links TEXT, contact_info TEXT, avatar_url TEXT, bio TEXT, website TEXT, created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP, updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP, notification_preferences TEXT, role_id INTEGER, last_login TIMESTAMP, active INTEGER); INSERT INTO tbl_users_new (user_id, first_name, last_name, username, password_hash, social_media_links, contact_info, avatar_url, bio, website, created_at, updated_at, notification_preferences, role_id, last_login, active) SELECT user_id, first_name, last_name, username, password_hash, social_media_links, contact_info, avatar_url, bio, website, created_at, updated_at, notification_preferences, role_id, last_login, active FROM tbl_users; DROP TABLE tbl_users; ALTER TABLE tbl_users_new RENAME TO tbl_users; COMMIT;"
      ]
    },
    "cleanup_sql": {
      "postgres": [
        "ALTER TABLE tbl_users DROP COLUMN IF EXISTS full_name;"
      ],
      "mysql": [
        "ALTER TABLE tbl_users DROP COLUMN full_name;"
      ],
      "sqlserver": [
        "IF EXISTS (SELECT 1 FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = 'tbl_users' AND COLUMN_NAME = 'full_name') ALTER TABLE tbl_users DROP COLUMN full_name;"
      ],
      "sqlite": [
        "BEGIN TRANSACTION; CREATE TABLE tbl_users_new (user_id INTEGER PRIMARY KEY, first_name TEXT, last_name TEXT, username TEXT, password_hash TEXT, social_media_links TEXT, contact_info TEXT, avatar_url TEXT, bio TEXT, website TEXT, created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP, updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP, notification_preferences TEXT, role_id INTEGER, last_login TIMESTAMP, active INTEGER); INSERT INTO tbl_users_new (user_id, first_name, last_name, username, password_hash, social_media_links, contact_info, avatar_url, bio, website, created_at, updated_at, notification_preferences, role_id, last_login, active) SELECT user_id, first_name, last_name, username, password_hash, social_media_links, contact_info, avatar_url, bio, website, created_at, updated_at, notification_preferences, role_id, last_login, active FROM tbl_users; DROP TABLE tbl_users; ALTER TABLE tbl_users_new RENAME TO tbl_users; COMMIT;"
      ]
    },
    "tags": [
      "DDL",
      "difficulty: moderate",
      "ALTER",
      "ADD_COLUMN",
      "CONCAT",
      "SORT"
    ],
    "other": {
      "nl_prompt_base": "Add a Generated Column full_name to tbl_users",
      "nl_prompt_extra_context": "Store first name and last name concatenated",
      "public": true
    }
  }
]